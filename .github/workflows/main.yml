name: Run tests on any Push event
# Controls when the workflow will run
on:
  # Triggers the workflow on push or pull request events but only for the main branch
  push:
    branches: [ master ]

# A workflow run is made up of one or more jobs that can run sequentially or in parallel
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Check out repository code
        uses: actions/checkout@v2
      - name: Run and check
        run: python calculator.py
      - name: Check out calculator tests
        run: python test.py
        
  build:
    runs-on: ubuntu-latest
    steps:
      - name: setup compiler
        run: pip install pyinstaller
      - name: compile to package
        run: pyinstaller calculator.py  --onefile --console
      - name: setup git config
        run: |
          git config user.name "GitHub Actions Bot"
          git config user.email "<>" 
      # commit files
      - name: Commit files
        run: | 
          git add dist/calculator
          git commit -m 'Changes pushed by GitHub Actions' || true
          git push origin master

